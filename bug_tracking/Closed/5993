From myers@eng.utah.edu  Tue Mar 11 09:09:18 2014
Return-Path: <myers@eng.utah.edu>
Received: from bowie.eng.utah.edu (bowie.eng.utah.edu [155.98.110.113])
	by chou.ece.utah.edu (8.14.7/8.14.4) with ESMTP id s2BF9IuI018744
	for <atacs-bugs@vlsigroup.ece.utah.edu>; Tue, 11 Mar 2014 09:09:18 -0600
Received: from c-67-177-39-60.hsd1.ut.comcast.net ([67.177.39.60] helo=[10.0.0.3])
	by bowie.eng.utah.edu with esmtpsa (TLSv1:AES128-SHA:128)
	(Exim 4.72 (FreeBSD))
	(envelope-from <myers@eng.utah.edu>)
	id 1WNOHc-0000zt-BO
	for atacs-bugs@vlsigroup.ece.utah.edu; Tue, 11 Mar 2014 09:07:56 -0600
From: "Chris J. Myers" <myers@ece.utah.edu>
Content-Type: multipart/alternative; boundary="Apple-Mail=_DD8D6B92-40E3-4DA1-BA5B-30CFAE6D795D"
Subject: CHANGE: some potential JSBML cleanup
Date: Tue, 11 Mar 2014 09:09:30 -0600
References: <5DFBC330-5DFF-49B9-9A03-3F3DBFE5B4CC@ece.utah.edu>
To: Leandro Watanabe <atacs-bugs@vlsigroup.ece.utah.edu>
Message-Id: <8EC3117E-013B-42BF-A7D9-3EFBD06057DE@ece.utah.edu>
Mime-Version: 1.0 (Mac OS X Mail 6.6 \(1510\))
X-Mailer: Apple Mail (2.1510)
Sender: myers@eng.utah.edu


--Apple-Mail=_DD8D6B92-40E3-4DA1-BA5B-30CFAE6D795D
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=iso-8859-1



Begin forwarded message:

> From: "Chris J. Myers" <myers@ece.utah.edu>
> Subject: Re: [sbml-discuss] Release of JSBML-1.0-beta1
> Date: March 11, 2014 9:06:32 AM MDT
> To: Curtis Madsen <Curtis.Madsen@newcastle.ac.uk>
> Cc: Leandro Watanabe <l.watanabe@utah.edu>
>=20
> I wonder how many of these changes were done in real-time as you were =
already using some of them.  That is unless Leandro made the change.
>> =20
>>  - A new convenience method, removeFromParent, has been added to =
SBase and TreeNodeWithChangeSupport. It offers the ability to remove any =
element from the JSBML tree from its parent.
>> I believe that I added a helper method in the SBML utilities class =
that could potentially be rewritten to use the new method.
>>=20
> I found this in SBMLutilities:
>=20
> 	public static void removeFromParentAndDelete(SBase element) {
> 		element.removeFromParent();
> 	}
>=20
>>  - An alternative class to parse mathematical formula has been =
implemented.  It is named FormulaParserLL3 and it respects the same =
syntax as the libSBML L3 parser.
>> I had to comment out the call to the libSBML L3 parser before, but =
now you should be able to call the JSBML L3 parser.
>>=20
> We seem to already be using their new parser.  I'm not sure though if =
there is a prefix parser that matches libsbml though.  Notice how we use =
the same parser regardless.
>=20
> 	public static ASTNode myParseFormula(String formula) {
> 		ASTNode mathFormula =3D null;
> 		Preferences biosimrc =3D Preferences.userRoot();
> 		try {
> 			IFormulaParser parser =3D new =
FormulaParserLL3(new StringReader(""));
> 			if (biosimrc.get("biosim.general.infix", =
"").equals("prefix")) {
> 				mathFormula =3D =
ASTNode.parseFormula(formula, parser);
> 			}
> 			else {
> 				mathFormula =3D =
ASTNode.parseFormula(formula, parser);
> 				// mathFormula =3D =
libsbml.parseL3Formula(formula);
> 			}
> 		}
> 		catch (ParseException e) {
> 			return null;
> 		}
> 		catch (Exception e) {
> 			return null;
> 		}
> 		if (mathFormula =3D=3D null)
> 			return null;
> 		setTimeAndTrigVar(mathFormula);
> 		return mathFormula;
> 	}
>=20
>=20
>>  - Syntax checking for SBML 'metaid' attributes have been added to =
the setMetaId method.
>> I seem to recall that there was a problem with setMetaId.  I'm not =
sure what I did to fix it, but it looks like they may have =
fixed/improved something that may make one or more of the methods in the =
SBML utilities class obsolete.
>>=20
> I think the problem was with resetting the metaId to itself and =
getting a metaId already in use error.  Here is how you fixed that.
>=20
> =09
> 	public static void setMetaId(AbstractSBase asb, String newId) {
> 		if (!asb.getMetaId().equals(newId)){
> 			asb.setMetaId(newId);
> 		}
> 	}
> =09
> 	public static void setMetaId(SBase asb, String newId) {
> 		if (!asb.getMetaId().equals(newId)){
> 			asb.setMetaId(newId);
> 		}
> 	}
>=20
>>  - When trying to remove a modifier, reactant, or product from a =
reaction using the id of the element, where no such element was present =
before, a NullPointerException was thrown. This has been solved. Thanks =
to Curtis Madsen for detecting this bug.
>> I believe that this is another situation where I created a method in =
the SBML utilities class that is no longer needed.
>>=20
> I think this is the method.  Did not find one for reactant and =
product.
>=20
> 	public static ModifierSpeciesReference removeModifier(Reaction =
r, String species) {
> 		if (r.getListOfModifiers() !=3D null) {
> 			return r.removeModifier(species);
> 		}
> 		return null;
> 	}
>=20
>> It's nice to see that they have fixed many of the issues I found when =
moving us over to JSBML.  I do recognize many of the other bug/feature =
fixes from the list, but I think the ones I listed above are the only =
ones that require any attention.
>> =20
> Thanks for the information on this.
>=20
> Chris
>=20


--Apple-Mail=_DD8D6B92-40E3-4DA1-BA5B-30CFAE6D795D
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=iso-8859-1

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html =
charset=3Diso-8859-1"></head><body style=3D"word-wrap: break-word; =
-webkit-nbsp-mode: space; -webkit-line-break: after-white-space; =
"><br><div><br><div>Begin forwarded message:</div><br =
class=3D"Apple-interchange-newline"><blockquote type=3D"cite"><div =
style=3D"margin-top: 0px; margin-right: 0px; margin-bottom: 0px; =
margin-left: 0px;"><span style=3D"font-family:'Helvetica'; =
font-size:medium; color:rgba(0, 0, 0, 1.0);"><b>From: </b></span><span =
style=3D"font-family:'Helvetica'; font-size:medium;">"Chris J. Myers" =
&lt;<a =
href=3D"mailto:myers@ece.utah.edu">myers@ece.utah.edu</a>&gt;<br></span></=
div><div style=3D"margin-top: 0px; margin-right: 0px; margin-bottom: =
0px; margin-left: 0px;"><span style=3D"font-family:'Helvetica'; =
font-size:medium; color:rgba(0, 0, 0, 1.0);"><b>Subject: =
</b></span><span style=3D"font-family:'Helvetica'; =
font-size:medium;"><b>Re: [sbml-discuss] Release of =
JSBML-1.0-beta1</b><br></span></div><div style=3D"margin-top: 0px; =
margin-right: 0px; margin-bottom: 0px; margin-left: 0px;"><span =
style=3D"font-family:'Helvetica'; font-size:medium; color:rgba(0, 0, 0, =
1.0);"><b>Date: </b></span><span style=3D"font-family:'Helvetica'; =
font-size:medium;">March 11, 2014 9:06:32 AM MDT<br></span></div><div =
style=3D"margin-top: 0px; margin-right: 0px; margin-bottom: 0px; =
margin-left: 0px;"><span style=3D"font-family:'Helvetica'; =
font-size:medium; color:rgba(0, 0, 0, 1.0);"><b>To: </b></span><span =
style=3D"font-family:'Helvetica'; font-size:medium;">Curtis Madsen =
&lt;<a =
href=3D"mailto:Curtis.Madsen@newcastle.ac.uk">Curtis.Madsen@newcastle.ac.u=
k</a>&gt;<br></span></div><div style=3D"margin-top: 0px; margin-right: =
0px; margin-bottom: 0px; margin-left: 0px;"><span =
style=3D"font-family:'Helvetica'; font-size:medium; color:rgba(0, 0, 0, =
1.0);"><b>Cc: </b></span><span style=3D"font-family:'Helvetica'; =
font-size:medium;">Leandro Watanabe &lt;<a =
href=3D"mailto:l.watanabe@utah.edu">l.watanabe@utah.edu</a>&gt;<br></span>=
</div><br><meta http-equiv=3D"Content-Type" content=3D"text/html =
charset=3Diso-8859-1"><div style=3D"word-wrap: break-word; =
-webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">I =
wonder how many of these changes were done in real-time as you were =
already using some of them. &nbsp;That is unless Leandro made the =
change.<br><div><blockquote type=3D"cite"><div bgcolor=3D"#FFFFFF" =
text=3D"#000000">&nbsp;<br>
&nbsp;- A new convenience method, removeFromParent, has been added to =
SBase and TreeNodeWithChangeSupport. It offers the ability to remove any =
element from the JSBML tree from its parent.<br>
I believe that I added a helper method in the SBML utilities class that =
could potentially be rewritten to use the new method.<br>
<br></div></blockquote><div>I found this in =
SBMLutilities:</div><div><br></div><div><div style=3D"margin: 0px; =
font-size: 11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">	</span><span style=3D"color: =
#931a68">public</span> <span style=3D"color: #931a68">static</span> =
<span style=3D"color: #931a68">void</span> =
removeFromParentAndDelete(SBase element) {</div><div style=3D"margin: =
0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">		=
</span>element.removeFromParent();</div><div style=3D"margin: 0px; =
font-size: 11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">	</span>}</div></div><br><blockquote =
type=3D"cite"><div bgcolor=3D"#FFFFFF" text=3D"#000000">
&nbsp;- An alternative class to parse mathematical formula has been =
implemented.&nbsp; It is named FormulaParserLL3 and it respects the same =
syntax as the libSBML L3 parser.<br>
I had to comment out the call to the libSBML L3 parser before, but now =
you should be able to call the JSBML L3 parser.<br>
<br></div></blockquote><div>We seem to already be using their new =
parser. &nbsp;I'm not sure though if there is a prefix parser that =
matches libsbml though. &nbsp;Notice how we use the same parser =
regardless.</div><div><br></div><div><div style=3D"margin: 0px; =
font-size: 11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">	</span><span style=3D"color: =
#931a68">public</span> <span style=3D"color: #931a68">static</span> =
ASTNode myParseFormula(String formula) {</div><div style=3D"margin: 0px; =
font-size: 11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span>ASTNode mathFormula =3D =
<span style=3D"color: #931a68">null</span>;</div><div style=3D"margin: =
0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">		=
</span>Preferences biosimrc =3D Preferences.userRoot();</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">		=
</span><span style=3D"color: #931a68">try</span> {</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">			=
</span>IFormulaParser parser =3D <span style=3D"color: =
#931a68">new</span> FormulaParserLL3(<span style=3D"color: =
#931a68">new</span> StringReader(<span style=3D"color: =
#3933ff">""</span>));</div><div style=3D"margin: 0px; font-size: 11px; =
font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">			</span><span =
style=3D"color: #931a68">if</span> (biosimrc.get(<span style=3D"color: =
#3933ff">"biosim.general.infix"</span>, <span style=3D"color: =
#3933ff">""</span>).equals(<span style=3D"color: =
#3933ff">"prefix"</span>)) {</div><div style=3D"margin: 0px; font-size: =
11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">				=
</span>mathFormula =3D ASTNode.parseFormula(formula, parser);</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">			=
</span>}</div><div style=3D"margin: 0px; font-size: 11px; font-family: =
Monaco; "><span class=3D"Apple-tab-span" style=3D"white-space:pre">		=
	</span><span style=3D"color: #931a68">else</span> {</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">				=
</span>mathFormula =3D ASTNode.parseFormula(formula, parser);</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; color: =
rgb(78, 144, 114); "><span style=3D""><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">				</span></span>// =
mathFormula =3D libsbml.parseL3Formula(formula);</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">			=
</span>}</div><div style=3D"margin: 0px; font-size: 11px; font-family: =
Monaco; "><span class=3D"Apple-tab-span" style=3D"white-space:pre">		=
</span>}</div><div style=3D"margin: 0px; font-size: 11px; font-family: =
Monaco; "><span class=3D"Apple-tab-span" style=3D"white-space:pre">		=
</span><span style=3D"color: #931a68">catch</span> (ParseException e) =
{</div><div style=3D"margin: 0px; font-size: 11px; font-family: Monaco; =
color: rgb(147, 26, 104); "><span style=3D""><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">			=
</span></span>return<span style=3D""> </span>null<span =
style=3D"">;</span></div><div style=3D"margin: 0px; font-size: 11px; =
font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span>}</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">		=
</span><span style=3D"color: #931a68">catch</span> (Exception e) =
{</div><div style=3D"margin: 0px; font-size: 11px; font-family: Monaco; =
color: rgb(147, 26, 104); "><span style=3D""><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">			=
</span></span>return<span style=3D""> </span>null<span =
style=3D"">;</span></div><div style=3D"margin: 0px; font-size: 11px; =
font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span>}</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">		=
</span><span style=3D"color: #931a68">if</span> (mathFormula =3D=3D =
<span style=3D"color: #931a68">null</span>)</div><div style=3D"margin: =
0px; font-size: 11px; font-family: Monaco; color: rgb(147, 26, 104); =
"><span style=3D""><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">			=
</span></span>return<span style=3D""> </span>null<span =
style=3D"">;</span></div><div style=3D"margin: 0px; font-size: 11px; =
font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		=
</span>setTimeAndTrigVar(mathFormula);</div><div style=3D"margin: 0px; =
font-size: 11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span><span style=3D"color: =
#931a68">return</span> mathFormula;</div><div style=3D"margin: 0px; =
font-size: 11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">	=
</span>}</div></div><div><br></div><br><blockquote type=3D"cite"><div =
bgcolor=3D"#FFFFFF" text=3D"#000000">
&nbsp;- Syntax checking for SBML 'metaid' attributes have been added to =
the setMetaId method.<br>
I seem to recall that there was a problem with setMetaId.&nbsp; I'm not =
sure what I did to fix it, but it looks like they may have =
fixed/improved something that may make one or more of the methods in the =
SBML utilities class obsolete.<br>
<br></div></blockquote><div>I think the problem was with resetting the =
metaId to itself and getting a metaId already in use error. &nbsp;Here =
is how you fixed that.</div><div><br></div><div><div style=3D"margin: =
0px; font-size: 11px; font-family: Monaco; min-height: 15px; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">	</span><br =
class=3D"webkit-block-placeholder"></div><div style=3D"margin: 0px; =
font-size: 11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">	</span><span style=3D"color: =
#931a68">public</span> <span style=3D"color: #931a68">static</span> =
<span style=3D"color: #931a68">void</span> setMetaId(AbstractSBase asb, =
String newId) {</div><div style=3D"margin: 0px; font-size: 11px; =
font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span><span style=3D"color: =
#931a68">if</span> (!asb.getMetaId().equals(newId)){</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">			=
</span>asb.setMetaId(newId);</div><div style=3D"margin: 0px; font-size: =
11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span>}</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">	=
</span>}</div><div style=3D"margin: 0px; font-size: 11px; font-family: =
Monaco; min-height: 15px; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">	</span><br =
class=3D"webkit-block-placeholder"></div><div style=3D"margin: 0px; =
font-size: 11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">	</span><span style=3D"color: =
#931a68">public</span> <span style=3D"color: #931a68">static</span> =
<span style=3D"color: #931a68">void</span> setMetaId(SBase asb, String =
newId) {</div><div style=3D"margin: 0px; font-size: 11px; font-family: =
Monaco; "><span class=3D"Apple-tab-span" style=3D"white-space:pre">		=
</span><span style=3D"color: #931a68">if</span> =
(!asb.getMetaId().equals(newId)){</div><div style=3D"margin: 0px; =
font-size: 11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">			=
</span>asb.setMetaId(newId);</div><div style=3D"margin: 0px; font-size: =
11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span>}</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">	=
</span>}</div></div><br><blockquote type=3D"cite"><div bgcolor=3D"#FFFFFF"=
 text=3D"#000000">
&nbsp;- When trying to remove a modifier, reactant, or product from a =
reaction using the id of the element, where no such element was present =
before, a NullPointerException was thrown. This has been solved. Thanks =
to Curtis Madsen for detecting this bug.<br>
I believe that this is another situation where I created a method in the =
SBML utilities class that is no longer needed.<br>
<br></div></blockquote><div>I think this is the method. &nbsp;Did not =
find one for reactant and product.</div><div><br></div><div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">	</span><span =
style=3D"color: #931a68">public</span> <span style=3D"color: =
#931a68">static</span> ModifierSpeciesReference removeModifier(Reaction =
r, String species) {</div><div style=3D"margin: 0px; font-size: 11px; =
font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span><span style=3D"color: =
#931a68">if</span> (r.getListOfModifiers() !=3D <span style=3D"color: =
#931a68">null</span>) {</div><div style=3D"margin: 0px; font-size: 11px; =
font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">			</span><span =
style=3D"color: #931a68">return</span> =
r.removeModifier(species);</div><div style=3D"margin: 0px; font-size: =
11px; font-family: Monaco; "><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span>}</div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; color: =
rgb(147, 26, 104); "><span style=3D""><span class=3D"Apple-tab-span" =
style=3D"white-space:pre">		</span></span>return<span =
style=3D""> </span>null<span style=3D"">;</span></div><div =
style=3D"margin: 0px; font-size: 11px; font-family: Monaco; "><span =
class=3D"Apple-tab-span" style=3D"white-space:pre">	=
</span>}</div></div><br><blockquote type=3D"cite"><div bgcolor=3D"#FFFFFF"=
 text=3D"#000000">
It's nice to see that they have fixed many of the issues I found when =
moving us over to JSBML.&nbsp; I do recognize many of the other =
bug/feature fixes from the list, but I think the ones I listed above are =
the only ones that require any attention.<br>
&nbsp;<br></div></blockquote>Thanks for the information on =
this.</div><div><br></div><div>Chris</div><br></div></blockquote></div><br=
></body></html>=

--Apple-Mail=_DD8D6B92-40E3-4DA1-BA5B-30CFAE6D795D--

