From: Chris Myers <atacs-bugs@vlsigroup.ece.utah.edu>
To: myers@ece.utah.edu
Subject: Re: FEATURE: fast reaction support (PR#4556)
Date: Tue Jun 29 14:31:32 2010

Here is one method:

The way of fast reaction treating described in the SBML documentation is quite
understandable, but it requires dae solver which can solve dae with mass matrix.
In my possession there is no such solver. But it seems, that we can obtain
system with differential variables completely separated from algebraic by linear
change of variables. To make it clear I will illustrate my approach on simple
example. Let's consider model 870 from sbml test suite. It contains two
reactions:
A4 -> A2 Rate: (Kf1*A4-Kr1*A2)*C Fast
A1+A2 -> A3 Rate: (Kf*A1*A2-Kr*A3)*C Slow
Denote fast reaction rate as F, slow as S.
Like in SBML documentation, we can write ODE system:

dA1/dt = -S
dA2/dt = F - S
dA3/dt = S
dA4/dt = -F

or in vector form (denoting species vector (A1, A2, A3, A4) = X):

dX/dt = Af*F + As*S

Where Af and As are one-column matrix

    0         -1
Af = 1    As = -1    
    0          1
   -1          0

then find matrix B - left null space of Af:

    1 0 0 0
B =  0 1 0 1
    0 0 1 0

and multiply both parts of our system by it, we obtain the dae system:

dA1/dt = -s
dA2/dt + dA4/dt = -S
dA3/dt = S
F=0

By the linearity of the transformation B you can always make a change of
variables like this:
Y = A2 + A4, and obtain, dae system where differential variables are separated
from algebraic:
F = (Kf1*A4-Kr1*A2)*C = 0
Y = A2 +A4
dA1/dt = -S
dY/dt = -S
dA3/dt = S

This system can be solved with solvers which doesn't allow premultiplication
with a mass matrix or (however, this is not strictly from a mathematical point
of view, but due to solver step is quite small gives good result) we can solve
algebraic system separately from the differential, launching an algebraic sorver
with value of Y retrieved on previous step before each step of the differential
solver, in this case we don't need dae solver. I think, dealing with fast
reactions as it described in SBML documentation, we can always use
transformation, described above, and obtain dae system with separated
differential and algebraic variables, and get correct results. Is it right?

P.S. In previous post Jim mentioned about the approach with linear change of
variables, which is used in VCell. May be it is something similar with approach
I described above?
--
Shadrin Alexey